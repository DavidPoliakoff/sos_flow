#!/bin/bash
if [ "$1" == "clean" ]
then
   rm -rf *~
   echo "Removing all binary objects."
   cd ..
   rm -rf ./bin
   mkdir bin
   rm -rf ./lib
   mkdir lib
   cd bin
   touch .keep
   cd ..
   cd lib
   touch .keep
   cd ..
   cd src
   echo "Wiped the ../bin folder, ../lib folder, and all binary contents.  Type './make' to rebuild."
else
    cd ..
    cd bin
    if [ ! -f CMakeCache.txt ] ; then
      cmake \
         -G "Unix Makefiles" \
         -DCMAKE_BUILD_TYPE=Debug \
         -DCMAKE_C_FLAGS=-O0 \
         --prefix=`pwd` \
         -DCMAKE_C_COMPILER=gcc \
         -DCMAKE_CXX_COMPILER=g++ \
         -DUSE_TAU=TRUE \
         -DTAU_ROOT=$HOME/src/tau2 \
         -DTAU_ARCH=x86_64 \
         -DTAU_OPTIONS=-mpi-pthread \
         ..
    fi
    make -j
    cd ..
    cd src
fi;
